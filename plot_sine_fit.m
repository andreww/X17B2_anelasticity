% PLOT_SINE_FIT
%
% Plots the raw results of the sine fitter code.
% 
% Usage: [period, temperature, force, normalised_compliance, ...
%   internal_friction] = run_sine_fit(fileglob)
% 
%    NOTE - A HACK: assumes we have exactly the right data.
%
% Andrew Walker - 20/3/2014

function plot_sine_fit(file)

    [p, t, f, s, phi] = read_sine_fit(file);

    figure
    subplot(2,2,1);
    plot(t(f==27&p==10), s(f==27&p==10), '.k', ...
        t(f==27&p==30), s(f==27&p==30), '.b', ...
        t(f==27&p==100), s(f==27&p==100), '.g', ...
        t(f==27&p==300), s(f==27&p==300), '.r')
    xlabel('Temperature (C)')
    ylabel('Normalised compliance')
    legend('10 s', '30 s', '100 s', '300 s');
    subplot(2,2,2);
    plot(t(f==27&p==10), phi(f==27&p==10), '.k', ...
        t(f==27&p==30), phi(f==27&p==30), '.b', ...
        t(f==27&p==100), phi(f==27&p==100), '.g', ...
        t(f==27&p==300), phi(f==27&p==300), '.r')
    xlabel('Temperature (C)')
    ylabel('Aparant internal friction (rad)')
    legend('10 s', '30 s', '100 s', '300 s');
    subplot(2,2,3);
    plot(log(p(f==27&t==25)), s(f==27&t==25), '.k', ...
        log(p(f==27&t==100)), s(f==27&t==100), '.b', ...
        log(p(f==27&t==150)), s(f==27&t==150), '.g', ...
        log(p(f==27&t==200)), s(f==27&t==200), '.r', ...
        log(p(f==27&t==250)), s(f==27&t==250), 'ok', ...
        log(p(f==27&t==300)), s(f==27&t==300), 'ob', ...
        log(p(f==27&t==400)), s(f==27&t==400), 'or')
    xlabel('log Period (s)')
    ylabel('Normalised compliance')
    legend('25 C', '100 C', '150 C', '200 C', '250 C', '300 C', '400 C');
    subplot(2,2,4);
    plot(log(p(f==27&t==25)), phi(f==27&t==25), '.k', ...
        log(p(f==27&t==100)), phi(f==27&t==100), '.b', ...
        log(p(f==27&t==150)), phi(f==27&t==150), '.g', ...
        log(p(f==27&t==200)), phi(f==27&t==200), '.r', ...
        log(p(f==27&t==250)), phi(f==27&t==250), 'ok', ...
        log(p(f==27&t==300)), phi(f==27&t==300), 'ob', ...
        log(p(f==27&t==400)), phi(f==27&t==400), 'or')
    xlabel('log period (s)')
    ylabel('Aparant internal friction (rad)')
    legend('25 C', '100 C', '150 C', '200 C', '250 C', '300 C', '400 C');


    figure
    subplot(2,2,1);
    plot(t(f==60&p==10), s(f==60&p==10), '.k', ...
        t(f==60&p==30), s(f==60&p==30), '.b', ...
        t(f==60&p==100), s(f==60&p==100), '.g', ...
        t(f==60&p==300), s(f==60&p==300), '.r')
    xlabel('Temperature (C)')
    ylabel('Normalised compliance')
    legend('10 s', '30 s', '100 s', '300 s');
    subplot(2,2,2);
    plot(t(f==60&p==10), phi(f==60&p==10), '.k', ...
        t(f==60&p==30), phi(f==60&p==30), '.b', ...
        t(f==60&p==100), phi(f==60&p==100), '.g', ...
        t(f==60&p==300), phi(f==60&p==300), '.r')
    xlabel('Temperature (C)')
    ylabel('Aparant internal friction (rad)')
    legend('10 s', '30 s', '100 s', '300 s');
    subplot(2,2,3);
    plot(log(p(f==60&t==25)), s(f==60&t==25), '.k', ...
        log(p(f==60&t==100)), s(f==60&t==100), '.b', ...
        log(p(f==60&t==200)), s(f==60&t==200), '.r', ...
        log(p(f==60&t==300)), s(f==60&t==300), 'ob', ...
        log(p(f==60&t==400)), s(f==60&t==400), 'or')
    xlabel('log Period (s)')
    ylabel('Normalised compliance')
    legend('25 C', '100 C', '200 C', '300 C',  '400 C');
    subplot(2,2,4);
    plot(log(p(f==60&t==25)), phi(f==60&t==25), '.k', ...
        log(p(f==60&t==100)), phi(f==60&t==100), '.b', ...
        log(p(f==60&t==200)), phi(f==60&t==200), '.r', ...
        log(p(f==60&t==300)), phi(f==60&t==300), 'ob', ...
        log(p(f==60&t==400)), phi(f==60&t==400), 'or')
    xlabel('log period (s)')
    ylabel('Aparant internal friction (rad)')
    legend('25 C', '100 C', '200 C', '300 C',  '400 C');
    
end